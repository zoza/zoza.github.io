
<!doctype html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Test CORS</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<link href="style.css" rel="stylesheet">
</head>
<body>
<div class="content-container">
	<h1 class="header">Test Your Connection</h1>
	<div class="get-post-block">
		<h3 class="options">Using Basic Authentication</h3>
		<button onclick="getApplicationByBasicAuth()">Get Applications</button>
		<button onclick="postApplicationByBasicAuth()">Post Application</button>
	</div>
	<div class="get-post-block">
		<h3 class="options">Using Token as Header</h3>
		<button onclick="getApplicationByTokenHeader()">Get Applications</button>
		<button onclick="postApplicationByTokenHeader()">Post Application</button>
	</div>
	<div class="get-post-block">
		<h3 class="options">Using Token as Query</h3>
		<button onclick="getApplicationByTokenQueryParams()">Get Applications</button>
		<button onclick="postApplicationByTokenQueryParams()">Post Application</button>
	</div>
	<div class="get-post-block">
	        <h3 class="options">Use Credentials</h3>
                <button onclick="getApplicationUseCredentials()">Get Applications</button>
                <button onclick="postApplicationUseCredentials()">Post Application</button>
        </div>
</div>
</body>
<script>
	var serverUrl = 'https://serverlb-managementbackendg-s8s9s78h.rnd.srv.ravcloud.com/';
    // Make sure your token has reading permission, and creation from specific blueprintid + permission for this blueprint (+execute).
	var token = 'XeyK0VEfD4CwsiUhOu8AyU8O4DxYYHWKk6D7Qm1A0GPlhShbyJX8FfbvWBDHlAqy';
	var blueprintId = '4587523';
	var userName = 'ravello@ravello.com';
	var password = 'ravello';


	function getNameList(data) {
		var nameList = '';
		for(var i = 0; i < data.length ; i++) {
			nameList += data[i].name + '\n';
		}
		return nameList;
	}
	function getApplicationByBasicAuth() {
		$.ajax(serverUrl + 'api/v1/applications', {
			beforeSend: function(xhr) {
				xhr.setRequestHeader('Authorization', 'Basic ' + btoa(userName + ':' + password));
			},
			dataType: 'json',
			success: function(data) {
				alert(getNameList(data));
			},
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'GET'
		});
	}

	function postApplicationByBasicAuth() {
		$.ajax(serverUrl + 'api/v1/applications', {
			beforeSend: function(xhr) {
                                xhr.setRequestHeader('Authorization', 'Basic ' + btoa(userName + ':' + password));
                        },
			contentType: 'application/json',
			dataType: 'json',
			data: JSON.stringify({ name: "test-"+ Math.random() }),
			success: function(data) {
				alert('Created new application with id: '+ data.id);
			},
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'POST'
		});
	}

	function getApplicationByTokenHeader() {
		$.ajax(serverUrl + 'api/v1/applications', {
			headers: {
				'X-Ephemeral-Token-Authorization': token
			},
			dataType: 'json',
			success: function(data) {
				alert(getNameList(data));
			},
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'GET'
		});
	}

	function postApplicationByTokenHeader() {
		$.ajax(serverUrl + 'api/v1/applications', {
			headers: {
				'X-Ephemeral-Token-Authorization': token
			},
			contentType: 'application/json',
			dataType: 'json',
			data: JSON.stringify({
				name: "test-"+ Math.random(),
				baseBlueprintId: 4587523
			}),
			success: function(data) {
				alert('Created new application with id: '+ data.id);
			},
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'POST'
		});
	}

	function getApplicationByTokenQueryParams() {
		$.ajax(serverUrl + 'api/v1/applications?token='+token, {
			success: function(data) {
				alert(getNameList(data));
			},
			dataType: 'json',
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'GET'
		});
	}

	function postApplicationByTokenQueryParams() {
		$.ajax(serverUrl + 'api/v1/applications?token='+token, {
			contentType: 'application/json',
			dataType: 'json',
			data: JSON.stringify({
				name: "test-"+ Math.random(),
				baseBlueprintId: 4587523
			}),
			success: function(data) {
				alert('Created new application with id: '+ data.id);
			},
			error: function(rejection) {
				alert(rejection.error().statusText)
			},
			type: 'POST'
		});
	}
        function getApplicationUseCredentials() {
                $.ajax(serverUrl + 'api/v1/applications', {
                        success: function(data) {
                                alert(getNameList(data));
                        },
 			xhrFields: {
			       withCredentials: true
			},
                        dataType: 'json',
                        error: function(rejection) {
                                alert(rejection.error().statusText)
                        },
                        type: 'GET'
                });
        }

        function postApplicationUseCredentials() {
                $.ajax(serverUrl + 'api/v1/applications', {
                        contentType: 'application/json',
                        dataType: 'json',
			xhrFields: {
                               withCredentials: true
                        },
                        data: JSON.stringify({
                                name: "test-"+ Math.random(),
                                baseBlueprintId: 4587523
                        }),
                        success: function(data) {
                                alert('Created new application with id: '+ data.id);
                        },
                        error: function(rejection) {
                                alert(rejection.error().statusText)
                        },
                        type: 'POST'
                });
        }
</script>
</html>

   
  
